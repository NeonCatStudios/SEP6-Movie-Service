@page "/movie/"
@using MovieApp.Data
@inject MovieController movieController

<head>
    <title>Movie</title>
</head>
<body>
<div style="display: flex; align-items: flex-start; justify-content: center; height: 100%">
    <div style="width: 55%">
        <p>@movieCache.Title</p>
        <p>Rating | @movieCache.imdbRating (@movieCache.imdbVotes)</p>
        <img style="width: 300px" src="@movieCache.Poster"/>
        <p>@movieCache.Year</p>
        <p>Country | @movieCache.Country</p>
        <p>Director | @movieCache.Director</p>
        <p>Writer | @movieCache.Writer</p>
        <p>Synopsis</p>
        <p>@movieCache.Plot</p>
    </div>
    <div style="width: 25%;">
        <p>Starring actors</p>
        <ul>
            @foreach (var i in Actors)
            {
                <li>@i.ToString()</li>
            }
        </ul>
    </div>
</div>
</body>

@code
{
    [Parameter]
    [SupplyParameterFromQuery(Name = "movieId")]
    public String movieId { get; set; } = "";

    private String RatingString;
    private List<String> Actors;
    public OMDBMovie movieCache = new OMDBMovie();

    protected override void OnInitialized()
    {
        movieId = movieId ?? "";
        movieId = "tt" + movieId;
        Console.WriteLine(movieId);
        GetMovieInfo(movieId);
    }

    public void GetMovieInfo(String id)
    {
        movieCache = movieController.getMovies(id);
        Actors = movieCache.Actors.Split(", ").ToList();
    }

}